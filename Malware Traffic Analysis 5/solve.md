Q1/. c41-MTA5-email-01: What is the name of the malicious file? 
Started by uploading all emails on VirusTotal and inspect them. All mails got flagged as malicious by many security vendors. On first one we go to Behavior tab and check Process Tree to retrieve the name of the malicious file.
> 460630672421.exe

Q2/.c41-MTA5-email-01: What is the name of the trojan family the malware belongs to? (As identified by emerging threats ruleset). 
Uploaded first email on HybridAnalysis and inspected Related Files to find our executabe. Sandbox reports identified the trojan family.
> Upatre

Q3/. c41-MTA5-email-01: The malware dropped two malicious files with the same hash but with different names. Provide the SHA256 hash of those files? (Check the report submitted in 2015). 
It literally says to check report from 2005.
> d1818c3fbbb1f09d8998ad44d14ee9a4fbfae5a1bb58128c2ac077a06d7f84b9
 
Q4/. c41-MTA5-email-01: How many DNS requests were initiated by the malware? (Check the report submitted in 2015). 
> 3

Q5/. c41-MTA5-email-02: Multiple streams contain macros in this document. Provide the number of the highest one.
I extracted an attachement from the first email, from Microsof Office Suite. I used oletools to anayze and gather info.
> 20

Q6/ .c41-MTA5-email-02: The Excel macro tried to download a file. Provide the full URL of this file? 
Upload the Excel document on VirusTotal.
> http://advancedgroup.net.au/~incantin/334g5j76/897i7uxqe.exe

Q7/. c41-MTA5-email-02: What is the name of the object used to get data from the download URL? 
To analyze Microsoft Office documents we're going to use oletools suite. I started by extracting VBA source code.
$ olevba -c Bill* > sourceCo.txt
Inspecting the source code I saw an object function called "read_same_ch_from3". This fuction will concatenate with the oject value "zilibobe" to another hardcoded string.
> Microsoft.XMLHTTP

Q8/. c41-MTA5-email-02: The Excel macro writes a file to the temp folder. Provide the filename? 
Go back to VirusTotal. In the Behavior tab we see written files by the malicious doc.
> tghtop.exe

Q9/. c41-MTA5-email-03: Provide the FQDN used by the attacker to store the login credentials?
In the DNS section of VirusTotal, we see many Domains that have interacted with the victim.
I extracted from the 3rd email AmericanExpress.html and uploaded it on HybridAnalysis.
On the sandbox test form 2017 we see some HTTP traffic making GET requests on FDQN jpmmotos.pt and get a match from the Domains found with VirusTotal.
> jpmmotos.pt

Q10/. c41-MTA5-email-04: How many FQDNs are present in the malicious js
I extracted "fax000497762.zip" from 4th email. Unzipped it and got a one liner js script. Used https://beautifier.io/ to make it readable.
Then compiled it on https://onecompiler.com/ and got another one liner in output.
Put it back to beautifier.io to read it.
> 3

Q11/. c41-MTA5-email-04: What is the name of the object used to handle and read files? 
> ADODB.Stream

Q12/. c41-MTA5.pcap: The victim received multiple emails; however, the user opened a single attachment. Provide the attachment filename. 
I filtered with tshark all GET requests in http stream. We see requests have been made to the same hardcoded address in the js script. We got our proof.
$ tshark -r *.pcap -Y "http.request || http.response" -O http| grep -i "GET" -A15 -B15
> fax000497762.zip

Q13/. c41-MTA5.pcap: What is the IP address of the victim machine?
> 10.3.66.103

Q14/.c41-MTA5.pcap: What is the hostname of the victim machine?
Filtering with tshark.
>STROUT-PC

Q15/.c41-MTA5.pcap: What is the FQDN that hosted the malware? 
>kennedy.sitoserver.com

Q16/.c41-MTA5.pcap: The opened attachment wrote multiple files to the TEMP folder. Provide the name of the first file written to the disk?
Analyzing the malicious JavaScript, I can see that once the HTTP GET request is successful, the “saveToFile()” file function is used.
“fn” variable contains a static string value
The “fn” variable will then be concatenated with “n” and “.exe” to provide the following filename:
>7997551.exe

Q17/.c41-MTA5.pcap: One of the written files to the disk has the following md5 hash "35a09d67bee10c6aff48826717680c1c"; Which registry key does this malware check for its existence?
>9a83a958-b859-11d1-aa90-00aa00ba3258

Q18/.c41-MTA5.pcap: One of the written files to the disk has the following md5 hash "e2fc96114e61288fc413118327c76d93" sent an HTTP post request to "upload.php" page. Provide the webserver IP. (IP is not in PCAP)
Analyzed the js script in HybridAnalysis.
> 78.24.220.229

Q19/.c41-MTA5.pcap: The malware initiated callback traffic after the infection. Provide the IP of the destination server. 
Lot's of packets from this address.
Filtered this IP in search.
In export objects we see many requests involving the sus stream we just saw.
> 109.68.191.31
